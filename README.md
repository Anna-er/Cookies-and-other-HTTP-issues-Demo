# Cookies and Other HTTP Issues Demo

Этот репозиторий содержит несколько небольших демонстрационных мини-сайтов на Go, показывающих типовые уязвимости веб-приложений:

* незащищённые cookie (без `Secure`, `HttpOnly`)
* перехват cookie в MITM (HTTP)
* XSS и кража cookie через `<script>`
* CSRF через невидимые запросы

Ниже описано, как запускать проекты, что смотреть в браузере, и как ловить уязвимости в Wireshark.

---

## Структура репозитория

```
cookies-http-demo/
├── mitm/         # демо перехвата cookie в HTTP
├── xss/          # демо XSS и кражи cookie
└── csrf/         # демо CSRF-атаки через картинку/автозапрос
```

В каждом проекте есть:

* `main.go` — серверная логика
* `static/` — HTML, изображения, CSS

---

## Как запускать

Каждое демо запускается одинаково:

```bash
cd <папка_демо>
go run main.go
```

После запуска открыть сайт по адресу, например:

```
MITM demo running on http://localhost:8080 …
```

---

## MITM Cookie Demo (HTTP)

**Папка:** `mitm/`

### Идея

Страница ставит cookie *без Secure и без HttpOnly*. Плюс сайт работает по чистому HTTP → cookie уходят в сеть в открытом виде.

### Как демонстрировать

1. Запустить:

   ```bash
   go run main.go
   ```
2. Открыть в браузере:
   `http://localhost:8080`
3. Обновлять страницу.
4. В Wireshark выбрать интерфейс (Wi-Fi/ethernet) и фильтр:

   ```
   http && tcp.port == 8080
   ```
5. В каждом запросе будет видно:
   `Cookie: sessionid=<ID>`

С каждым новым браузером/инкогнито ID будет другой → это видно в трафике.

---

## XSS Demo

**Папка:** `xss/`

### Идея

Пользователь пишет комментарии, но сайт выводит текст без фильтрации → можно вставить JS:

```html
<script>fetch('/steal?c=' + document.cookie)</script>
```

Сервер выведет украденную cookie в консоль.

### Как демонстрировать

1. Запустить:

   ```bash
   go run main.go
   ```
2. Открыть:
   `http://localhost:8081`
3. Ввести обычный текст — всё ок.
4. Ввести XSS-пэйлоад (выше) — сервер покажет:

   ```
   Stolen cookies: sessionid=...
   ```
5. Показать, что cookie не защищена HttpOnly → JS её читает.

---

## CSRF Demo

**Папка:** `csrf/`

### Идея

Злоумышленник делает страницу, но внутри невидимая картинка отправляет запрос на «банк»:

```html
<img src="http://localhost:8000/transfer?to=attacker" style="display:none">
```

### Как демонстрировать

Требуются **два сервера**:

1. **Bank**

   ```bash
   cd csrf/bank
   go run main.go
   ```

   Открыть: `http://localhost:8000`

2. **Attacker**

   ```bash
   cd csrf/attacker
   go run main.go
   ```

   Открыть: `http://localhost:9000`

### Демонстрация атаки

* Пользователь `victim` авторизован в банке.
* Переходит на сайт злоумышленника (`9000`).
* Скрытая `<img>` делает запрос — банк принимает, потому что cookie отправляется автоматически.

В истории перевозов банка будет видно, что произошёл перевод и деньги ушли.

---

## Wireshark

### Фильтры

* HTTP-трафик к конкретному демо:

  ```
  http && tcp.port == 8080
  ```
* POST/GET запросы:

  ```
  http.request.method == "GET" || http.request.method == "POST"
  ```

### Что демонстрируется

* Для MITM — перехват cookie в чистом виде.
* Для CSRF — невидимый запрос из сторонней страницы.
* Для XSS — кражу cookie в консоли сервера.
